<HTML DIR="LTR"> 
   <HEAD>
      <TITLE>IDA Pro Plugin Wizard</TITLE> 
      <META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
      <META HTTP-EQUIV="MSThemeCompatible" CONTENT="Yes">
      <STYLE TYPE="text/css">@import url();
      </STYLE>
      <SCRIPT>
          var oWizard = window.external;
          var strPath = oWizard.FindSymbol("SCRIPT_COMMON_PATH");
          if (strPath != null && strPath != "")
          {
              document.styleSheets(0).imports(0).href = strPath + "/NewStyles.css";
          }
          else
          {
              var strURL = GetCommonScriptPath();
              strURL += "/NewStyles.css";
              document.styleSheets(0).imports(0).href = strURL;
          }
      </SCRIPT>
   </HEAD>
   <BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0"
         ONLOAD="InitDocument(document);"
         ONKEYDOWN="if (!bValidating) OnKey();"
         ONKEYPRESS="if (!bValidating) OnPress();">
      <TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
         <COL CLASS="LinkPane">
         <COL> 
         <TR VALIGN="TOP">
            <TD HEIGHT="65" WIDTH="100%" COLSPAN="2"> 
               <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
               <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                  <COL WIDTH="12">
                  <COL>
                  <COL WIDTH="12"> 
                  <TR>
                     <TD VALIGN="TOP" HEIGHT="12" WIDTH="12"> &nbsp; 
                     </TD>
                     <TD VALIGN="TOP" HEIGHT="12"> &nbsp; 
                     </TD>
                     <TD VALIGN="TOP" HEIGHT="12" WIDTH="12"> &nbsp; 
                     </TD>
                     <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2"> 
                        <DIV CLASS="SMALLA" ID="PROCESSOR_MODULE_IMAGE" STYLE="DISPLAY:BLOCK;"> 
                           <IMG CLASS="SMALLEST" SRC="../../Images/IDAProWizard.gif" ALT="" BORDER="0"> 
                        </DIV>
                        <DIV CLASS="SMALL" ID="PLUGIN_MODULE_IMAGE" STYLE="DISPLAY:NONE;"> 
                           <IMG CLASS="SMALL" SRC="../../Images/IDAProWizard.gif" ALT="" BORDER="0"> 
                        </DIV>
                        <DIV CLASS="SMALL" ID="LOADER_MODULE_IMAGE" STYLE="DISPLAY:NONE;"> 
                           <IMG CLASS="SMALL" SRC="../../Images/IDAProLoader.gif" ALT="" BORDER="0"> 
                        </DIV>
                        <DIV CLASS="SMALL" ID="DEBUGGER_MODULE_IMAGE" STYLE="DISPLAY:NONE;"> 
                           <IMG CLASS="SMALL" SRC="../../Images/IDAProWizard.gif" ALT="" BORDER="0"> 
                        </DIV>
                        <DIV CLASS="SMALL" ID="DECOMPILER_MODULE_IMAGE" STYLE="DISPLAY:NONE;"> 
                           <IMG CLASS="SMALL" SRC="../../Images/IDAProHexRay.gif" ALT="" BORDER="0"> 
                        </DIV>
                     </TD>
                     <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2"> &nbsp; 
                     </TD>
                  </TR>
                  <TR>
                     <TD VALIGN="TOP" HEIGHT="65" WIDTH="12"> &nbsp; 
                     </TD>
                     <TD VALIGN="TOP" HEIGHT="65"> 
                        <H4 CLASS="HEAD" ID="HEAD">Welcome to IDA Pro Plugin Wizard</H4>
                        <P CLASS="SUBHEAD" ID="SUBHEAD">This wizard generates a IDA Pro Plugin project. The project can be a plugin module, processor module, loader module, debugger module, or a decompiler module.</P> 
                     </TD>
                     <TD VALIGN="TOP" HEIGHT="65" WIDTH="12"> &nbsp; 
                     </TD>
                  </TR>
                  <TR>
                     <TD CLASS="RULE" VALIGN="TOP" HEIGHT="2" COLSPAN="5"> 
                        <TABLE HEIGHT="1" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                           <TR VALIGN="TOP">
                              <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW">
                              </TD>
                              <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW">
                              </TD>
                           </TR>
                        </TABLE>
                     </TD>
                  </TR>
               </TABLE>
               <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
            </TD>
         </TR>
         <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
         <TR VALIGN="TOP">
            <TD CLASS="Three" HEIGHT="100%" VALIGN="TOP" WIDTH="100%"> 
               <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                  <TR VALIGN="TOP">
                     <TD CLASS="threeCustom" VALIGN="TOP"> 
                        <!--OPEN OF NAVIGATION TABLE//-->
                        <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                           <COL WIDTH="12">
                           <COL>
                           <COL WIDTH="1"> 
                           <TR>
                              <TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" HEIGHT="100%">
                                 &nbsp; 
                              </TD>
                              <!--OPEN OF NAVIGATIONAL LINKS//-->
                              <TD HEIGHT="100%" VALIGN="TOP"> 
                                 <DIV CLASS="LINK"> 
                                    <TABLE CLASS="LINKTEXT" HEIGHT="28" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                       <TR VALIGN="MIDDLE">
                                          <TD WIDTH="162"> 
                                             <SPAN CLASS="ACTIVELINK" ID="Default" ONCLICK="Next(document, 'Default.htm');" TABINDEX="1"
                                                   TITLE="Examine an overview of selections.">
                                                Overview
                                             </SPAN>
                                          </TD>
                                          <TD WIDTH="4"> 
                                             <IMG SRC="../../Images/spacer.gif" WIDTH="4" HEIGHT="1"> 
                                          </TD>
                                       </TR>
                                    </TABLE>
                                 </DIV>
                                 <DIV CLASS="LINK"> 
                                    <TABLE CLASS="LINKTEXT" HEIGHT="28" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                       <TR VALIGN="MIDDLE">
                                          <!--TD WIDTH="162"//--> 
                                          <TD WIDTH="100%"> 
                                             <SPAN CLASS="ACTIVELINK" ID="Settings" ONCLICK="Next(document, 'Settings.htm');" TABINDEX="2"
                                                   TITLE="Specify the type of plugin you will build with this project and the options or libraries you want supported.">
                                                Settings...
                                             </SPAN> 
                                          </TD>
                                          <TD WIDTH="4"> 
                                             <IMG SRC="../../Images/spacer.gif" WIDTH="4" HEIGHT="1"> 
                                          </TD>
                                       </TR>
                                    </TABLE>
                                 </DIV>
                                 <DIV CLASS="LINKSELECTED"> 
                                    <SPAN CLASS="VERTLINE1"> 
                                       <IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"> 
                                    </SPAN>
                                    <SPAN CLASS="HORILINE1"> 
                                       <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                          <TR VALIGN="TOP">
                                             <TD CLASS="DOTTEDLINE" HEIGHT="1"> 
                                             </TD>
                                          </TR>
                                          <TR VALIGN="TOP">
                                             <TD HEIGHT="100%"> 
                                                <IMG SRC="../../Images/spacer.gif" HEIGHT="28" WIDTH="1" ALT="" BORDER="0"> 
                                             </TD>
                                          </TR>
                                          <TR VALIGN="TOP">
                                             <TD CLASS="DOTTEDLINE" HEIGHT="1"> 
                                             </TD>
                                          </TR>
                                       </TABLE>
                                    </SPAN> 
                                    <TABLE CLASS="LINKTEXTSELECTED" WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                       <TR VALIGN="MIDDLE">
                                          <TD WIDTH="100%"> 
                                             <SPAN ID="Features" TITLE="">
                                                Features
                                             </SPAN> 
                                          </TD>
                                          <TD WIDTH="4"> 
                                             <IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4"> 
                                          </TD>
                                       </TR>
                                    </TABLE>
                                 </DIV>
                              </TD>
                              <!--CLOSE OF NAVIGATIONAL LINKS//-->
                              <TD WIDTH="1"> 
                                 <DIV CLASS="VERTLINE"> 
                                    <IMG ALT="" BORDER="0" HEIGHT="1"
                                         SRC="../../Images/spacer.gif" WIDTH="1"> 
                                 </DIV>
                              </TD>
                           </TR>
                        </TABLE>
                        <!--CLOSE OF NAVIGATION TABLE//-->
                     </TD>
                  </TR>
               </TABLE>
            </TD>
            <TD HEIGHT="100%" VALIGN="TOP"> 

            <!--OPEN OF CONTENT AND BUTTON TABLE//-->
               <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="ONE">
                  <COL WIDTH="100%"> 
                  <TR VALIGN="TOP">
                     <TD HEIGHT="100%">
                        <!--OPEN OF CONTENT//-->
                        <TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                           <COL WIDTH="12"> 
                           <COL WIDTH="398"> 
                           <COL WIDTH="12"> 
                           <TR>
                              <TD VALIGN="TOP" HEIGHT="9" COLSPAN="3">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" WIDTH="12">
                                 &nbsp; 
                              </TD>
                              <TD VALIGN="TOP"> 
                                 <TABLE CLASS="FixedSize" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                    <COL WIDTH="193"> 
                                    <COL WIDTH="12"> 
                                    <COL WIDTH="193"> 
                                    <TR>
                                       <TD VALIGN="TOP"> 
                                          <SPAN CLASS="itemTextTop" ID="COMPANY_NAME_SPAN" TITLE="What is the author company name for this plug-in?.">
                                             <LABEL FOR="COMPANY_NAME" ID="COMPANY_NAME_LABEL">Company <U>N</U>ame:</LABEL>
                                             <BR> 
                                             <INPUT CLASS="sideBtn" TYPE="text" ID="COMPANY_NAME" ACCESSKEY="e"
                                                    TABINDEX="12"
                                                    TITLE="What is the author company name for this plug-in?."> 
                                          </SPAN> 
                                          <P CLASS="ElementSpacer2">
                                             
                                          </P>
                                          <SPAN CLASS="itemTextTop" ID="PLUGIN_VERSION_SPAN" TITLE="The version of the plugin.">
                                             <LABEL FOR="PLUGIN_VERSION" ID="PLUGIN_VERSION_LABEL"><U>V</U>ersion:</LABEL>
                                             <BR> 
                                             <INPUT CLASS="sideBtn" TYPE="text" ID="PLUGIN_VERSION" ACCESSKEY="V"
                                                    TABINDEX="13"
                                                    TITLE="The version of the plugin."> 
                                          </SPAN> 
                                          <P CLASS="ElementSpacer2">
                                             &nbsp;
                                          </P>
                                          <SPAN CLASS="itemTextTop" ID="IDA_SDK_VERSION_TITLE" TITLE="Specify which version of IDA that this plug-in is for.">
                                             <LABEL ID="IDA_SDK_VERSION_LABEL" FOR="IDA_SDK_VERSION">IDA SD<U>K</U> version:</LABEL>
                                             <BR>
                                             <SELECT CLASS="sidebtn" ID="IDA_SDK_VERSION" ACCESSKEY="K" TITLE="Specify which version of IDA that this plug-in is for."
                                                SIZE="1">
                                                <OPTION VALUE="650" selected>IDA Pro 6.5.140116</OPTION>
                                                <OPTION VALUE="640">IDA Pro 6.4.xx</OPTION>
                                                <OPTION VALUE="630">IDA Pro 6.3.120531</OPTION>
                                                <OPTION VALUE="620">IDA Pro 6.2.0.0111006</OPTION>
                                                <OPTION VALUE="610">IDA Pro 6.1.0.110408</OPTION>
                                                <OPTION VALUE="600">IDA Pro 6.0.0.101130</OPTION>
                                                <OPTION VALUE="570">IDA Pro 5.7.0.935</OPTION>
                                                <OPTION VALUE="560">IDA Pro 5.6.0.931</OPTION>
                                                <OPTION VALUE="550">IDA Pro 5.5.0.925</OPTION>
                                                <OPTION VALUE="540">IDA Pro 5.4.0.921</OPTION>
                                                <OPTION VALUE="520">IDA Pro 5.2.0.098</OPTION>
                                                <OPTION VALUE="510">IDA Pro 5.1.0.899</OPTION>
                                             </SELECT>
                                          </SPAN>
                                       </TD>
                                       <TD VALIGN="TOP" WIDTH="12">
                                          &nbsp; 
                                       </TD>
                                       <TD VALIGN="TOP"> 
                                          <SPAN CLASS="itemTextTop" ID="PLUGIN_AUTHOR_SPAN" TITLE="The name of the author.">
                                             <LABEL FOR="PLUGIN_AUTHOR" ID="PLUGIN_AUTHOR_LABEL"><U>A</U>uthor Name:</LABEL>
                                             <BR> 
                                             <INPUT CLASS="sideBtn" TYPE="text" ID="PLUGIN_AUTHOR" ACCESSKEY="e"
                                                    TABINDEX="14"
                                                    TITLE="The name of the author."> 
                                          </SPAN> 
                                          <P CLASS="ElementSpacer2">
                                            
                                          </P>
                                          <SPAN CLASS="itemTextTop" ID="PLUGIN_URL_SPAN" TITLE="The URL to the author's web site">
                                             <LABEL FOR="PLUGIN_URL" ID="PLUGIN_URL_LABEL">Web <U>S</U>ite:</LABEL> 
                                             <BR> 
                                             <INPUT CLASS="sideBtn" TYPE="text" ID="PLUGIN_URL" ACCESSKEY="S" 
                                                    TABINDEX="15"
                                                    TITLE="The URL to the author's web site.">
                                          </SPAN> 
                                       </TD>
                                    </TR>
                                 </TABLE>
                              </TD>
                              <TD VALIGN="TOP" WIDTH="12">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" HEIGHT="9" COLSPAN="3">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" WIDTH="12">
                                 &nbsp; 
                              </TD>
                              <TD VALIGN="TOP">
                                 <DIV ID="PLUGIN_INFO">
                                 <TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                    <TR>
                                       <TD>
                                          <SPAN CLASS="itemTextTop" ID="EDIT_HELP_SPAN" TITLE="Multiline help about the plugin."> 
                                             <LABEL FOR="EDIT_HELP" ID="EDIT_HELP_LABEL">Plugin <U>H</U>elp:</LABEL>
                                             <BR>
                                             <TEXTAREA ROWS="4" COLS="80" ID="EDIT_HELP" ACCESSKEY="h" TABINDEX="8"
                                                TITLE="Multiline help about the plugin."
                                                STYLE="WIDTH:100%;overflow:auto;"
                                                onblur="StoreLastValue(this);"
                                                onkeyup="return DisableEnterKey(event, this);"
                                                onkeydown="return DisableEnterKey(event, this);"
                                                onkeypress="return DisableEnterKey(event, this);">
                                             </TEXTAREA>
                                             <BR>
                                             <P CLASS="ElementSpacer2">
                                                &nbsp;
                                             </P> 
                                          </SPAN> 
                                       </TD>
                                    </TR>
                                    <TR>
                                       <TD>
                                          <SPAN CLASS="itemTextTop" ID="EDIT_COMMENT_SPAN" TITLE="Long comment about the plugin it could appear in the status line or as a hint."> 
                                             <LABEL FOR="EDIT_COMMENT" ID="EDIT_COMMENT_LABEL">Plugin <U>C</U>omment:</LABEL>
                                             <BR>
                                             <TEXTAREA ROWS="2" COLS="80" ID="EDIT_COMMENT" ACCESSKEY="c" TABINDEX="9"
                                                TITLE="Long comment about the plugin it could appear in the status line or as a hint."
                                                STYLE="WIDTH:100%;overflow:auto;"
                                                onblur="StoreLastValue(this);"
                                                onkeyup="return DisableEnterKey(event, this);"
                                                onkeydown="return DisableEnterKey(event, this);"
                                                onkeypress="return DisableEnterKey(event, this);">
                                             </TEXTAREA>
                                             <BR>
                                             <P CLASS="ElementSpacer2">
                                                &nbsp;
                                             </P> 
                                          </SPAN> 
                                       </TD>
                                    </TR>
                                    <TR>
                                       <TD>
                                          <TABLE CLASS="FixedSize" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                             <COL WIDTH="193"> 
                                             <COL WIDTH="12"> 
                                             <COL WIDTH="193"> 
                                             <TR>
                                                <TD VALIGN="TOP"> 
                                                   <SPAN CLASS="itemTextTop" ID="WANTED_NAME_SPAN" TITLE="The preferred short name of the plugin.">
                                                      <LABEL FOR="WANTED_NAME" ID="WANTED_NAME_LABEL"><U>W</U>anted Name:</LABEL>
                                                      <BR> 
                                                      <INPUT CLASS="sideBtn" TYPE="text" ID="WANTED_NAME" ACCESSKEY="e"
                                                             TABINDEX="10"
                                                             TITLE="The preferred short name of the plugin."> 
                                                   </SPAN> 
                                                </TD>
                                                <TD VALIGN="TOP" WIDTH="12">
                                                   &nbsp; 
                                                </TD>
                                                <TD VALIGN="TOP"> 
                                                   <SPAN CLASS="itemTextTop" ID="WANTED_HOTKEY_SPAN" TITLE="The preferred hotkey to run the plugin.">
                                                      <LABEL FOR="WANTED_HOTKEY" ID="WANTED_HOTKEY_LABEL">Wanted Hot<U>K</U>ey:</LABEL> 
                                                      <BR> 
                                                      <INPUT CLASS="sideBtn" TYPE="text" ID="WANTED_HOTKEY" ACCESSKEY="K" READONLY
                                                             TABINDEX="11"
                                                             TITLE="The preferred short name of the plugin. Place the cursor inside this text box, and then press any key."
                                                             STYLE="text-align:center;font-weight:bold;"
                                                             onkeyup="OnWantedHotKey(event, this);"
                                                             onkeydown="OnWantedHotKey(event, this);"
                                                             onkeypress="OnWantedHotKey(event, this);">
                                                   </SPAN> 
                                                </TD>
                                             </TR>
                                          </TABLE>
                                       </TD>
                                    </TR>
                                 </TABLE>
                                 </DIV>
                              </TD>
                              <TD VALIGN="TOP" WIDTH="12">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" COLSPAN="3" HEIGHT="100%">
                                 &nbsp; 
                              </TD>
                           </TR>
                        </TABLE>
                        <!--CLOSE OF CONTENT//-->
                     </TD>
                  </TR>
                  <TR VALIGN="BOTTOM">
                     <TD> 
                        <!--OPEN OF BUTTON HTML//-->
                        <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
                           <COL WIDTH="12">
                           <COL>
                           <COL WIDTH="75">
                           <COL WIDTH="4">
                           <COL WIDTH="75">
                           <COL WIDTH="4">
                           <COL WIDTH="75">
                           <COL WIDTH="12">
                           <TR>
                              <TD CLASS="RULE" VALIGN="TOP" HEIGHT="2" COLSPAN="8">
                                 <TABLE HEIGHT="1" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
                                    <TR VALIGN="TOP">
                                       <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW">
                                       </TD>
                                       <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW">
                                       </TD>
                                    </TR>
                                 </TABLE>
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
                                 &nbsp; 
                              </TD>
                              <TD VALIGN="TOP" HEIGHT="23">
                                 &nbsp; 
                              </TD>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75"> 
                                 <BUTTON CLASS="BUTTONS" ACCESSKEY="F" ID="FinishBtn" ONCLICK="OnFinish(document);">
                                    <U>F</U>inish
                                 </BUTTON>
                              </TD>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
                                 &nbsp; 
                              </TD>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75"> 
                                 <BUTTON CLASS="BUTTONS" ACCESSKEY="C" ID="CancelBtn" ONCLICK="oWizard.Finish(document, 'cancel');">
                                    <U>C</U>ancel
                                 </BUTTON>
                              </TD>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
                                 &nbsp; 
                              </TD>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75"> 
                                 <BUTTON CLASS="BUTTONS" ACCESSKEY="H" ID="HelpBtn" ONCLICK="oWizard.OnHelp('vc.appwiz.custom.overview');">
                                    <U>H</U>elp
                                 </BUTTON>
                              </TD>
                              <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
                                 &nbsp; 
                              </TD>
                           </TR>
                           <TR>
                              <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
                                 &nbsp; 
                              </TD>
                           </TR>
                        </TABLE>
                        <!--CLOSE OF BUTTON HTML//-->
                     </TD>
                  </TR>
               </TABLE>
               <!--CLOSE CONTENT, AND BUTTON TABLES//-->
            </TD>
         </TR>
         <!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
      </TABLE>
   </BODY>
</HTML> 
<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = Settings;
tab_array[2] = Features;

// This is an example of a function which initializes the page
//
function InitDocument(document)
{
    setDirection();

    if (oWizard.FindSymbol('DOCUMENT_FIRST_LOAD'))
    {
        // This function sets the default symbols based
        // on the values specified in the SYMBOL tags above
        //
        oWizard.SetDefaults(document);
    }

    // Load the document and initialize the controls
    // with the appropriate symbol values
    //
    oWizard.Load(document);
    InitControls();
    ToggleImage();
    /*
    var input = document.getElementById("WANTED_HOTKEY");
    var hotKeyHook = function (event, input) { OnWantedHotKey(event, input); };
    HookEvent(input, 'focus', hotKeyHook);
    HookEvent(input, 'keyup', hotKeyHook);
    HookEvent(input, 'keydown', hotKeyHook);
    HookEvent(input, 'keypress', hotKeyHook);
    */
    LoadLastValue(EDIT_HELP);
    LoadLastValue(EDIT_COMMENT);
}

// If the wizard has more than 1 page, this
// function will browse to the page specified
//
function Next(document, linkto)
{
	oWizard.Next(document, linkto);
}

// This is an example of a function which
// gets called when the user clicks on 'Finish'
//
function OnFinish(document)
{
	OnWizFinish(document);
}

function LoadLastValue(target)
{
    var source;
    if (target.id == 'EDIT_HELP')
        source = oWizard.FindSymbol('PLUGIN_HELP');
    if (target.id == 'EDIT_COMMENT')
        source = oWizard.FindSymbol('PLUGIN_COMMENT');
    target.value = "";
    source = source.replace(/\\\n/g, '\r\n');
    source = source.replace(/\\\t/g, '\t');
    target.value = source;
}

function StoreLastValue(source)
{
    var target;
    if (source.id == 'EDIT_HELP')
        target = "PLUGIN_HELP";
    if (source.id == 'EDIT_COMMENT')
        target = "PLUGIN_COMMENT";
    var html = source.innerHTML;
    html = html.replace(/\r\n/g, '\\\n');
    html = html.replace(/\t/g, '\\\t');
    oWizard.AddSymbol(target, html);
}

function InitControls()
{
    PLUGIN_INFO.style.display = 'none';
    if (oWizard.FindSymbol("PLUGIN_MODULE") || oWizard.FindSymbol("DECOMPILER_MODULE") || oWizard.FindSymbol("DEBUGGER_MODULE"))
    {
        PLUGIN_INFO.style.display = 'block';
        EDIT_HELP.focus();
    }
}

function insertAtCursor(input, strValue)
{
    if (document.selection)
    {
        input.focus();
        // This gets the current selection or cursor location
        var inputRange = document.selection.createRange();
        // Replaces the current selection with a character or simply inserts it at the current cursor position
        inputRange.text = strValue;
        // This resets the selection
        inputRange.collapse(true);
        // And this executes above statement.
        inputRange.select();
    }
    //MOZILLA/NETSCAPE support
    else if (input.selectionStart || input.selectionStart == 0)
    {
        var startPos = input.selectionStart;
        var endPos = input.selectionEnd;
        var scrollTop = input.scrollTop;
        startPos = (startPos == -1 ? input.value.length : startPos);
        input.value = input.value.substring(0, startPos) + strValue + input.value.substring(endPos, input.value.length);
        input.focus();
        input.selectionStart = startPos + strValue.length;
        input.selectionEnd = startPos + strValue.length;
        input.scrollTop = scrollTop;
    }
    else
    {
        var scrollTop = input.scrollTop;
        input.value += strValue;
        input.focus();
        input.scrollTop = scrollTop;
    }
}

function DisableEnterKey(event, obj)
{
    var evtobj = event || window.event;
    var keyCode = (evtobj.keyCode ? evtobj.keyCode : (evtobj.which ? evtobj.which : evtobj.charCode));
    var eventName = evtobj.type;
    if ( eventName.substring(0, 2) == 'on' )
        eventName = eventName.substring(2, eventName.length);
    switch ( eventName )
    {
    case "keyup":
    case "keydown":
        break;
    case "keypress":
        var strText;
        switch (keyCode)
        {
            case VKeyCode.VK_RETURN:
                strText = '\r\n';
                break;
            case VKeyCode.VK_TAB:
                strText = "\t";
                break;
            default:
                if (event.keyCode < 32 || event.keyCode > 255)
                    return true;
                strText = String.fromCharCode(event.keyCode);
        }
        insertAtCursor(evtobj.srcElement, strText);
    }
    stopEvent(evtobj);
    return cancelEvent(evtobj);
}

function getEventTarget(event)
{
    event = event || window.event;
    return event.target || event.srcElement;
}

// Return true if Alt key is pressed
// @param {Event} evt
// @return {Boolean}
//
function AltPressed(e)
{
   if (window.event)
      return (window.event.altKey);
   return e.modifiers ? (e.altKey || (e.modifiers % 2)) : e.altKey;
}

// Return true if Ctrl key is pressed
// @param {Event} evt
// @return {Boolean}
//
function CtrlPressed(e)
{
   // as usual, Opera brings few "suprises" here
   if (window.event)
      return (window.event.ctrlKey);
   return (e.ctrlKey || (e.metaKey && window.opera) || (e.modifiers == 2) || (e.modifiers == 3) || (e.modifiers > 5));
}

// Return true if Shift key is pressed
// @param {Event} evt
// @return {Boolean}
//
function ShiftPressed(e)
{
   if (window.event)
      return (window.event.shiftKey);
   return (e.shiftKey || (e.modifiers > 3));
}

function HookEvent(element, eventName, callback)
{
    //Check if control is a string
    if (typeof (element) == "string")
        element = document.getElementById(element);
    if (element != null)
    {
        if (element.addEventListener)
        {
            // all browsers except IE before version 9
            return element.addEventListener(eventName, callback, false);
        }
        else if (element.detachEvent)
        {
            // IE before version 9
            eventName = "on" + eventName;
            return element.attachEvent(eventName, callback);
        }
    }
    else
    {
        target["on" + eventName] = callback; 
        return true;
    }
}

function UnhookEvent(element, eventName, callback)
{
    //Check if control is a string
    if (typeof (element) == "string")
        element = document.getElementById(element);
    if (element != null)
    {
        if (element.removeEventListener)
        {
            // all browsers except IE before version 9
            return element.removeEventListener(eventName, callback, false);
        }
        else if (element.detachEvent)
        {
            // IE before version 9
            return element.detachEvent("on" + eventName, callback);
        }
    }
    else
    {
        return false;
    }
}

function stopEvent(event)
{
    var evtobj = event || window.event;
    if ('bubbles' in evtobj)
    {
        // all browsers except IE before version 9
        if (evtobj.bubbles)
            evtobj.stopPropagation();
    }
    else
    {
        // Internet Explorer before version 9
        // always cancel bubbling
        evtobj.cancelBubble = true;
    }
}

function cancelEvent(event)
{
    var evtobj = event || window.event;
    if ('cancelable' in evtobj)
    {
        // all browsers except IE before version 9
        // in Firefox, the cancelable property always returns true,
        // so the cancelable state of the event cannot be determined
        if (event.cancelable)
        {
            event.preventDefault();
        }
    }
    else
    {
        // IE before version 9
        event.returnValue = false;
    }
    return false;
}

function FromKeyCode(keyCode)
{
    var between = function (a, b)
    {
        return a <= keyCode && keyCode <= b
    }
    var navKeys = "SPACE PAGEUP PAGEDOWN END HOME LEFT UP RIGHT DOWN".split(" ");
    var specialKeys =
    {
         8: "BACKSPACE",
         9: "TAB",
        45: "INS",
        46: "DEL"
    };
    return (between(VKeyCode.VK_A, VKeyCode.VK_Z) ? String.fromCharCode(keyCode) :
			between(VKeyCode.VK_0, VKeyCode.VK_9) ? String.fromCharCode(keyCode) :
			between(VKeyCode.VK_NUMPAD0, VKeyCode.VK_NUMPAD9) ? String.fromCharCode(keyCode - 48) :
			between(VKeyCode.VK_F1, VKeyCode.VK_F12) ? "F" + parseInt(keyCode - VKeyCode.VK_F1 + 1) :
			between(VKeyCode.VK_SPACE, VKeyCode.VK_DOWN) ? navKeys[keyCode - VKeyCode.VK_SPACE] :
			specialKeys.hasOwnProperty(keyCode) ? specialKeys[keyCode] :
			null);
}

function OnWantedHotKey(event, control)
{
    var evtobj = event || window.event;
    var keyCode = (evtobj.keyCode ? evtobj.keyCode : (evtobj.which ? evtobj.which : evtobj.charCode));
    var eventName = evtobj.type;
    if ( eventName.substring(0, 2) == 'on' )
        eventName = eventName.substring(2, eventName.length);
    switch ( eventName )
    {
        case "keypress":
        {
            //control.style.color = "black";
            control.style.backgroundColor = "cyan";
        }
        break;
        case "keyup":
        {
            //control.style.color = "";
            control.style.backgroundColor = "";
            //evtobj.keyCode = 0;
            //evtobj.repeat = false;
            //return true;
        }
        break;
        case "keydown":
        {
            //control.style.color = "white";
            control.style.backgroundColor = "red";
        }
        var actualkey = FromKeyCode(keyCode);
        if (!evtobj.repeat && actualkey != null)
        {
            var strModifiers = "";
            if (CtrlPressed(evtobj))
                strModifiers = "Ctrl+";
            if (AltPressed(evtobj))
                strModifiers += "Alt+";
            if (ShiftPressed(evtobj))
                strModifiers += "Shift+";
            control.value = strModifiers + actualkey;
        }
    }
    stopEvent(evtobj);
    return cancelEvent(evtobj);
}

function ToggleImage()
{
    PROCESSOR_MODULE_IMAGE.style.display = 'none';
    PLUGIN_MODULE_IMAGE.style.display = 'none';
    LOADER_MODULE_IMAGE.style.display = 'none';
    DEBUGGER_MODULE_IMAGE.style.display = 'none';
    DECOMPILER_MODULE_IMAGE.style.display = 'none';

    if (oWizard.FindSymbol("PLUGIN_MODULE"))
    {
        PLUGIN_MODULE_IMAGE.style.display = 'block';
    }
    else if (oWizard.FindSymbol("DECOMPILER_MODULE"))
    {
        DECOMPILER_MODULE_IMAGE.style.display = 'block';
    }
    else if (oWizard.FindSymbol("DEBUGGER_MODULE"))
    {
        DEBUGGER_MODULE_IMAGE.style.display = 'block';
    }
    else if (oWizard.FindSymbol("LOADER_MODULE"))
    {
        LOADER_MODULE_IMAGE.style.display = 'block';
    }
    else if (oWizard.FindSymbol("PROCESSOR_MODULE"))
    {
        PROCESSOR_MODULE_IMAGE.style.display = 'block';
    }
}
</SCRIPT> 
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT> 
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT> 

<!-- 
Common.js is a script file which contains the helper functions 
used by the wizards.  Include this line if you want to
call these functions from your html scripts.
//-->
<SCRIPT>
   function GetCommonScriptPath()
   {
      var strPath = oWizard.FindSymbol("PRODUCT_INSTALLATION_DIR");
      strPath += "VCWizards/";
      strPath += oWizard.GetHostLocale();
      // verify if the locale folder really exists
      var fso = new ActiveXObject("Scripting.FileSystemObject");
      var found = fso.FolderExists(strPath)
      if (found == false)
      {
         strPath = oWizard.FindSymbol("PRODUCT_INSTALLATION_DIR");
         strPath += "VCWizards/";
         var folder = fso.GetFolder(strPath);
         for (subfolders = new Enumerator(folder.SubFolders); !subfolders.atEnd(); subfolders.moveNext())
         {
            for (files = new Enumerator(subfolders.item().files); !files.atEnd(); files.moveNext())
            {
               if (files.item().name.toLowerCase().localeCompare("common.js") == 0)
               {
                  found = true;
                  strPath += subfolders.item().name;
                  break;              
               }
            }
            if (found == true)
               break;
         }
         oWizard.ReportError("Found Path: " + strPath);
      }
      return (strPath);
   }
   var strPath = oWizard.FindSymbol("SCRIPT_COMMON_PATH");
   if (strPath != null && strPath != "")
   {
      document.scripts("INCLUDE_SCRIPT").src = strPath + "/Script.js";
      document.scripts("INCLUDE_COMMON").src = strPath + "/Common.js";
   }
   else
   {
      var strPath = GetCommonScriptPath();
      document.scripts("INCLUDE_SCRIPT").src = strPath + "/Script.js";
      document.scripts("INCLUDE_COMMON").src = strPath + "/Common.js";
   }
</SCRIPT> 
<SCRIPT> 
// the virtual key code enum
VKeyCode =
{
	VK_LBUTTON  : 0x01, //Left mouse button  
	VK_RBUTTON  : 0x02, //Right mouse button  
	VK_CANCEL   : 0x03, //Control-break processing  
	VK_MBUTTON	: 0x04, //Middle mouse button (three-button mouse)  
	VK_BACK		: 0x08, //BACKSPACE key  
	VK_TAB      : 0x09, //TAB key  
	VK_CLEAR    : 0x0C, //CLEAR key  
	VK_RETURN   : 0x0D, //ENTER key  
	VK_SHIFT	   : 0x10, //SHIFT key  
	VK_CONTROL  : 0x11, //CTRL key  
	VK_MENU		: 0x12, //ALT key  
	VK_PAUSE    : 0x13, //PAUSE key  
	VK_CAPITAL	: 0x14, //CAPS LOCK key  
	VK_ESCAPE	: 0x1B, //ESC key  
	VK_SPACE    : 0x20, //SPACEBAR  
	VK_PRIOR    : 0x21, //PAGE UP key  
	VK_NEXT		: 0x22, //PAGE DOWN key  
	VK_END		: 0x23, //END key  
	VK_HOME		: 0x24, //HOME key  
	VK_LEFT		: 0x25, //LEFT ARROW key  
	VK_UP		   : 0x26, //UP ARROW key  
	VK_RIGHT	   : 0x27, //RIGHT ARROW key  
	VK_DOWN		: 0x28, //DOWN ARROW key  
	VK_SELECT	: 0x29, //SELECT key  
	VK_PRINT	   : 0x2A, //PRINT key 
	VK_EXECUTE	: 0x2B, //EXECUTE key  
	VK_SNAPSHOT	: 0x2C, //PRINT SCREEN key  
	VK_INSERT	: 0x2D, //INS key  
	VK_DELETE	: 0x2E, //DEL key  
	VK_HELP		: 0x2F, //HELP key  
	VK_0		   : 0x30, //0 key  
	VK_1		   : 0x31, //1 key  
	VK_2		   : 0x32, //2 key  
	VK_3		   : 0x33, //3 key  
	VK_4		   : 0x34, //4 key  
	VK_5		   : 0x35, //5 key  
	VK_6		   : 0x36, //6 key  
	VK_7		   : 0x37, //7 key  
	VK_8		   : 0x38, //8 key  
	VK_9		   : 0x39, //9 key  
	VK_A		   : 0x41, //A key  
	VK_B		   : 0x42, //B key  
	VK_C		   : 0x43, //C key  
	VK_D		   : 0x44, //D key  
	VK_E		   : 0x45, //E key  
	VK_F		   : 0x46, //F key  
	VK_G		   : 0x47, //G key  
	VK_H		   : 0x48, //H key  
	VK_I		   : 0x49, //I key  
	VK_J		   : 0x4A, //J key  
	VK_K		   : 0x4B, //K key  
	VK_L		   : 0x4C, //L key  
	VK_M		   : 0x4D, //M key  
	VK_N		   : 0x4E, //N key  
	VK_O		   : 0x4F, //O key  
	VK_P		   : 0x50, //P key  
	VK_Q		   : 0x51, //Q key  
	VK_R		   : 0x52, //R key  
	VK_S		   : 0x53, //S key  
	VK_T		   : 0x54, //T key  
	VK_U		   : 0x55, //U key  
	VK_V		   : 0x56, //V key  
	VK_W		   : 0x57, //W key  
	VK_X		   : 0x58, //X key  
	VK_Y		   : 0x59, //Y key  
	VK_Z		   : 0x5A, //Z key  
	VK_NUMPAD0	: 0x60, //Numeric keypad 0 key  
	VK_NUMPAD1	: 0x61, //Numeric keypad 1 key  
	VK_NUMPAD2	: 0x62, //Numeric keypad 2 key  
	VK_NUMPAD3	: 0x63, //Numeric keypad 3 key  
	VK_NUMPAD4	: 0x64, //Numeric keypad 4 key  
	VK_NUMPAD5	: 0x65, //Numeric keypad 5 key  
	VK_NUMPAD6	: 0x66, //Numeric keypad 6 key  
	VK_NUMPAD7	: 0x67, //Numeric keypad 7 key  
	VK_NUMPAD8	: 0x68, //Numeric keypad 8 key  
	VK_NUMPAD9	: 0x69, //Numeric keypad 9 key  
	VK_SEPARATOR: 0x6C, //Separator key  
	VK_SUBTRACT	: 0x6D, //Subtract key  
	VK_DECIMAL	: 0x6E, //Decimal key  
	VK_DIVIDE	: 0x6F, //Divide key  
	VK_F1		   : 0x70, //F1 key  
	VK_F2		   : 0x71, //F2 key  
	VK_F3		   : 0x72, //F3 key  
	VK_F4		   : 0x73, //F4 key  
	VK_F5		   : 0x74, //F5 key  
	VK_F6		   : 0x75, //F6 key  
	VK_F7		   : 0x76, //F7 key  
	VK_F8		   : 0x77, //F8 key  
	VK_F9		   : 0x78, //F9 key  
	VK_F10		: 0x79, //F10 key  
	VK_F11		: 0x7A, //F11 key  
	VK_F12		: 0x7B, //F12 key  
	VK_NUMLOCK	: 0x90, //NUM LOCK key  
	VK_SCROLL	: 0x91, //SCROLL LOCK key  
	VK_LSHIFT	: 0xA0, //Left SHIFT key 
	VK_RSHIFT	: 0xA1, //Right SHIFT key 
	VK_LCONTROL	: 0xA2, //Left CONTROL key 
	VK_RCONTROL	: 0xA3, //Right CONTROL key 
	VK_LMENU	   : 0xA4, //Left MENU key 
	VK_RMENU	   : 0xA5, //Right MENU key 
	VK_PLAY		: 0xFA, //Play key 
	VK_ZOOM		: 0xFB, //Zoom key 
	VK_OEM_MINUS: 0xBD, //MINUS 
	VK_OEM_PERIOD:0xBE  //PERIOD
};
</SCRIPT> 
